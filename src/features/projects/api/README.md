# src/features/projects/api

Здесь размещаются хуки и функции для работы с проектами через REST API WorkTech.

## Структура
- **use-create-project.ts** — создание нового проекта.
- **use-get-project.ts** — получение данных одного проекта.
- **use-get-projects.ts** — получение списка проектов пользователя (кроме администраторов).
- **...** — другие хуки для работы с проектами.

## Как работает
- Каждый хук инкапсулирует вызов определённого эндпоинта WorkTech API.
- Все хуки используют централизованный API-клиент (`rpc.ts`) для авторизации, обработки токенов и ошибок.
- Хуки учитывают роли пользователей при выполнении запросов.
- Для администраторов некоторые запросы блокируются или возвращают пустые данные.

## Особенности ролевой модели

### useGetProjects
```tsx
const { data: projects, isLoading } = useGetProjects();
```
- Для обычных пользователей: получает список проектов через API
- Для администраторов: 
  - Не делает запрос к API
  - Возвращает пустой массив
  - Устанавливает isLoading в false

### Оптимизация
- Запросы кэшируются с помощью React Query
- Для админов запросы к API проектов блокируются
- Учитывается состояние загрузки пользователя перед выполнением запросов

## Пример использования

```tsx
import { useGetProjects } from './use-get-projects';

function ProjectList() {
  const { data: projects, isLoading, error } = useGetProjects();

  if (isLoading) return <Loader />;
  if (error) return <ErrorMessage />;
  if (!projects?.length) return <EmptyState />;

  return <ProjectGrid projects={projects} />;
}
```

## Безопасность
- Проверка ролей происходит до выполнения запросов
- Административные функции полностью изолированы
- Запросы к API выполняются только для авторизованных пользователей с соответствующими правами 